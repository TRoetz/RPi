<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lights Control</title>
  <style>
    .toggle-button {
      /* Add some basic styling for the toggle buttons (optional) */
      display: inline-block;
      width: 250px;
      height: 30px;
      border-radius: 15px;
      background-color: #ccc;
      cursor: pointer;
      position: relative;
      transition: background-color 0.2s ease-in-out;
    }

    .toggle-button::after {
      content: "";
      display: block;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background-color: white;
      opacity: 15%;
      position: absolute;
      top: 2px;
      left: 2px;
      transition: left 0.2s ease-in-out;
    }

    .toggle-button.active::after {
      left: calc(100% - 25px);
      opacity: 15%;
      background-color: #4CAF50;  /* Change active color here */
    }
  </style>
</head>
<body>
  <h1>Lights Control</h1>
  <button type="button" class="toggle-button" id="toggle-all" onclick="toggleAllRelays()">Toggle All</button>
  <br/>
  {% for data in relay_data %}
    <button type="button" class="toggle-button" data-relay-id="{{ loop.index }}" onclick="toggleRelay(this)">
      {{ data["name"] }}
    </button>
    <br/>
  {% endfor %}
  <script>
    function toggleAllRelays() {
      // Send a POST request to "/toggle_all" with appropriate data
      fetch("/toggle_all", {
        method: "POST",
        // Add logic to send data about toggling all relays
      })
      .then(response => response.text())
      .then(data => {
        // Handle success or error response from the server
        console.log(data);
      })
      .catch(error => {
        console.error(error);
      });
    }

    function toggleRelay(button) {
      const relayId = button.dataset.relayId;
      // Send a POST request to "/toggle/<relay_id>" with appropriate data
      fetch(`/toggle/${relayId}`, {
        method: "POST",
        // Add logic to send data about toggling the specific relay
      })
      .then(response => response.text())
      .then(data => {
        // Handle success or error response from the server
        console.log(data);
        if (data === "OK") {
          button.classList.toggle("active");
        }
      })
      .catch(error => {
        console.error(error);
      });
    }
  </script>
</body>
</html>